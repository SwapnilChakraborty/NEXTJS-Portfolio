{"version":3,"file":"commonObjectTracing.js","sources":["../../../../src/common/utils/commonObjectTracing.ts"],"sourcesContent":["import type { PropagationContext } from '@sentry/types';\n\nconst commonMap = new WeakMap<object, PropagationContext>();\n\n/**\n * Takes a shared (garbage collectable) object between resources, e.g. a headers object shared between Next.js server components and returns a common propagation context.\n *\n * @param commonObject The shared object.\n * @param propagationContext The propagation context that should be shared between all the resources if no propagation context was registered yet.\n * @returns the shared propagation context.\n */\nexport function commonObjectToPropagationContext(\n  commonObject: unknown,\n  propagationContext: PropagationContext,\n): PropagationContext {\n  if (typeof commonObject === 'object' && commonObject) {\n    const memoPropagationContext = commonMap.get(commonObject);\n    if (memoPropagationContext) {\n      return memoPropagationContext;\n    } else {\n      commonMap.set(commonObject, propagationContext);\n      return propagationContext;\n    }\n  } else {\n    return propagationContext;\n  }\n}\n"],"names":[],"mappings":";;AAEA,MAAM,SAAU,GAAE,IAAI,OAAO,EAA8B,CAAA;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,gCAAgC;AAChD,EAAE,YAAY;AACd,EAAE,kBAAkB;AACpB,EAAsB;AACtB,EAAE,IAAI,OAAO,YAAA,KAAiB,QAAS,IAAG,YAAY,EAAE;AACxD,IAAI,MAAM,yBAAyB,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;AAC9D,IAAI,IAAI,sBAAsB,EAAE;AAChC,MAAM,OAAO,sBAAsB,CAAA;AACnC,WAAW;AACX,MAAM,SAAS,CAAC,GAAG,CAAC,YAAY,EAAE,kBAAkB,CAAC,CAAA;AACrD,MAAM,OAAO,kBAAkB,CAAA;AAC/B,KAAI;AACJ,SAAS;AACT,IAAI,OAAO,kBAAkB,CAAA;AAC7B,GAAE;AACF;;;;"}