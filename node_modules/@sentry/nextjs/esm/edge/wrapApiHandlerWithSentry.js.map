{"version":3,"file":"wrapApiHandlerWithSentry.js","sources":["../../../src/edge/wrapApiHandlerWithSentry.ts"],"sourcesContent":["import { getActiveSpan } from '@sentry/core';\n\nimport { withEdgeWrapping } from '../common/utils/edgeWrapperUtils';\nimport type { EdgeRouteHandler } from './types';\n\n/**\n * Wraps a Next.js edge route handler with Sentry error and performance instrumentation.\n */\nexport function wrapApiHandlerWithSentry<H extends EdgeRouteHandler>(\n  handler: H,\n  parameterizedRoute: string,\n): (...params: Parameters<H>) => Promise<ReturnType<H>> {\n  return new Proxy(handler, {\n    apply: (wrappingTarget, thisArg, args: Parameters<H>) => {\n      const req = args[0];\n\n      const activeSpan = getActiveSpan();\n\n      const wrappedHandler = withEdgeWrapping(wrappingTarget, {\n        spanDescription:\n          activeSpan || !(req instanceof Request)\n            ? `handler (${parameterizedRoute})`\n            : `${req.method} ${parameterizedRoute}`,\n        spanOp: activeSpan ? 'function' : 'http.server',\n        mechanismFunctionName: 'wrapApiHandlerWithSentry',\n      });\n\n      return wrappedHandler.apply(thisArg, args);\n    },\n  });\n}\n\n/**\n * @deprecated Use `wrapApiHandlerWithSentry` instead.\n */\nexport const withSentryAPI = wrapApiHandlerWithSentry;\n"],"names":[],"mappings":";;;AAKA;AACA;AACA;AACO,SAAS,wBAAwB;AACxC,EAAE,OAAO;AACT,EAAE,kBAAkB;AACpB,EAAwD;AACxD,EAAE,OAAO,IAAI,KAAK,CAAC,OAAO,EAAE;AAC5B,IAAI,KAAK,EAAE,CAAC,cAAc,EAAE,OAAO,EAAE,IAAI,KAAoB;AAC7D,MAAM,MAAM,GAAI,GAAE,IAAI,CAAC,CAAC,CAAC,CAAA;AACzB;AACA,MAAM,MAAM,UAAA,GAAa,aAAa,EAAE,CAAA;AACxC;AACA,MAAM,MAAM,cAAe,GAAE,gBAAgB,CAAC,cAAc,EAAE;AAC9D,QAAQ,eAAe;AACvB,UAAU,cAAc,EAAE,GAAA,YAAe,OAAO,CAAA;AAChD,cAAc,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC,CAAA;AAC9C,cAAc,CAAC,EAAA,GAAA,CAAA,MAAA,CAAA,CAAA,EAAA,kBAAA,CAAA,CAAA;AACA,QAAA,MAAA,EAAA,UAAA,GAAA,UAAA,GAAA,aAAA;AACA,QAAA,qBAAA,EAAA,0BAAA;AACA,OAAA,CAAA,CAAA;AACA;AACA,MAAA,OAAA,cAAA,CAAA,KAAA,CAAA,OAAA,EAAA,IAAA,CAAA,CAAA;AACA,KAAA;AACA,GAAA,CAAA,CAAA;AACA,CAAA;AACA;AACA;AACA;AACA;AACA,MAAA,aAAA,GAAA;;;;"}